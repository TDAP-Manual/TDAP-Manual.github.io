

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Input File Description &mdash; TDAP Help stable documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributors" href="Contributors.html" />
    <link rel="prev" title="Compilation" href="Compilation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> TDAP Help
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Compilation.html">Compilation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Input File Description</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#time-evolution">Time Evolution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#propagation">Propagation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#solutionmethod-string">SolutionMethod ( <em>String</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-newinv-logical">TD.NewInv ( <em>Logical</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-finaltimestep-integer">TD.FinalTimeStep ( <em>Integer</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-lengthtimestep-real-time">TD.LengthTimeStep ( <em>Real Time</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-emptybands-integer">TD.EmptyBands ( <em>Integer</em> )</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#population-switch">Population switch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#td-populationtransition-data-block">TD.PopulationTransition ( <em>data block</em> )</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tuned-electric-field">Tuned electric field</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#externalelectricfield-data-block">ExternalElectricField ( <em>data block</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-gaugefield-data-block">TD.GaugeField ( <em>data block</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-deltaelectricfield-logical">TD.DeltaElectricField ( <em>Logical</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-lightfrequency-real-frequency">TD.LightFrequency ( <em>Real Frequency</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-lightinitialtime-real-time">TD.LightInitialTime ( <em>Real time</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-lighttimescale-real-time">TD.LightTimeScale ( <em>Real time</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-efzmin-real">TD.EfZmin ( <em>Real</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-efzmax-real">TD.EfZmax ( <em>Real</em> )</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#analysis">Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#band-projection">Band projection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#td-writedmofselectiveorbitals-logical">TD.WriteDMOfSelectiveOrbitals ( <em>Logical</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-partialdmband-data-block">TD.PartialDMBand ( <em>data block</em> )</a></li>
<li class="toctree-l4"><a class="reference internal" href="#td-partialdmsumorbitals-data-block">TD.PartialDMSumOrbitals ( <em>data block</em> )</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#restart-a-tddft-md-calculation">Restart a TDDFT-MD calculation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Contributors.html">Contributors</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TDAP Help</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Input File Description</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/TimeEvolution.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="input-file-description">
<h1>Input File Description<a class="headerlink" href="#input-file-description" title="Permalink to this headline">¶</a></h1>
<div class="section" id="time-evolution">
<h2>Time Evolution<a class="headerlink" href="#time-evolution" title="Permalink to this headline">¶</a></h2>
<div class="section" id="propagation">
<h3>Propagation<a class="headerlink" href="#propagation" title="Permalink to this headline">¶</a></h3>
<p>TDAP is aimed at carrying out real time simulations of electron and nuclear dynamics from first principles. The solution method is to solve a time-evolving Schr”odinger equation <span class="math notranslate nohighlight">\(\psi(t+dt)=\exp(-idtH)\psi(t)\)</span>, instead of diagonalize <span class="math notranslate nohighlight">\(H\)</span> with <span class="math notranslate nohighlight">\(H\psi=E\psi\)</span>. For this purpose, a set of parameters specified below are needed for real time evolution of quantum states.</p>
<div class="section" id="solutionmethod-string">
<h4>SolutionMethod ( <em>String</em> )<a class="headerlink" href="#solutionmethod-string" title="Permalink to this headline">¶</a></h4>
<p>Character string to chose between diagonalization (<strong>diagon</strong>) or Order-N (<strong>OrderN</strong> ) solution of the LDA Hamiltonian or the TDDFT solver ( <strong>evolve</strong> ).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Always use <strong>evolve</strong>  to do the TDDFT calculation, otherwise all the parameters listed below will not be read.</p>
</div>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">diagon</span></code></p>
</div>
<div class="section" id="td-newinv-logical">
<h4>TD.NewInv ( <em>Logical</em> )<a class="headerlink" href="#td-newinv-logical" title="Permalink to this headline">¶</a></h4>
<p>If set this parameter to be true, the TD evolve operator is <span class="math notranslate nohighlight">\(\frac{S-iHdt/2}{S+iHdt/2}\)</span>, else  <span class="math notranslate nohighlight">\(\frac{1-iS^{-1}Hdt/2}{1+iS^{-1}Hdt/2}\)</span> .
The old version of TDAP use  <span class="math notranslate nohighlight">\(\frac{1-iS^{-1}Hdt/2}{1+iS^{-1}Hdt/2}\)</span>.
Now you can use the new faster method by set it to be true.
<code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">False</span></code></p>
</div>
<div class="section" id="td-finaltimestep-integer">
<h4>TD.FinalTimeStep ( <em>Integer</em> )<a class="headerlink" href="#td-finaltimestep-integer" title="Permalink to this headline">¶</a></h4>
<p>Final time step of the TD simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of BOMD steps is max( MD.FinalTimeStep - TD.FinalTimeStep , 1)</p>
</div>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">1</span></code></p>
</div>
<div class="section" id="td-lengthtimestep-real-time">
<h4>TD.LengthTimeStep ( <em>Real Time</em> )<a class="headerlink" href="#td-lengthtimestep-real-time" title="Permalink to this headline">¶</a></h4>
<p>Length of the time step of the TD simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Best to be the same as MD.LengthTimeStep. Unit in fs.</p>
</div>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">1.0</span> <span class="pre">fs</span></code></p>
</div>
<div class="section" id="td-emptybands-integer">
<h4>TD.EmptyBands ( <em>Integer</em> )<a class="headerlink" href="#td-emptybands-integer" title="Permalink to this headline">¶</a></h4>
<p>The number of unoccupied bands to be considered in density matrix calculation, etc.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">5</span></code></p>
</div>
</div>
<div class="section" id="population-switch">
<h3>Population switch<a class="headerlink" href="#population-switch" title="Permalink to this headline">¶</a></h3>
<p>To prepare an initial excited state to start a time-dependent simulation, one can choose in which states electrons are pumped to another (empty) states. The population switch method allows such electronic transitions from a given set of initial and final states to occur in the simulated systems, with features specified by the user.</p>
<div class="section" id="td-populationtransition-data-block">
<h4>TD.PopulationTransition ( <em>data block</em> )<a class="headerlink" href="#td-populationtransition-data-block" title="Permalink to this headline">¶</a></h4>
<p>Includes arbitrary number of lines. Each line with the format :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Start Band -- End band -- Jumped Electrons
</pre></div>
</div>
<p>Start Band is The band from which the electron is excited. If <span class="math notranslate nohighlight">\(\geq\)</span> 0, no excitation occurs.
End band is The band to which the electron is excited.
Jumped Electrons is the number of electrons pumped from Start Band to End band.</p>
<p>For instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%block TD.PopulationTransition
-1 2  0.5
-1 1  0.5
%endblock TD.PopulationTransition
</pre></div>
</div>
<p>Means that 0.5 electrons are pumped each from the HOMO band to the LUMO band and the band higher than LUMO.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">No</span> <span class="pre">default</span> <span class="pre">values</span></code></p>
</div>
</div>
<div class="section" id="tuned-electric-field">
<h3>Tuned electric field<a class="headerlink" href="#tuned-electric-field" title="Permalink to this headline">¶</a></h3>
<p>The electric field can be tuned to vary across z direction of the cell or to change with time. For basic concepts and cautions in applying electric field in the simulations, please refer to the <strong>ExternalElectricField</strong> tag, which control the value of field intensity <span class="math notranslate nohighlight">\(E_0\)</span>.  You also can apply vector field by  <strong>TD.GaugeField</strong> tag.</p>
<p>For the time-dependent changes, a Gaussian form wavepackage is implemented as:
<span class="math notranslate nohighlight">\(E(t)=E_0\cos(2\pi f t)\exp(-\frac{(t-t_0)^2}{2\sigma^2})\)</span></p>
<div class="section" id="externalelectricfield-data-block">
<h4>ExternalElectricField ( <em>data block</em> )<a class="headerlink" href="#externalelectricfield-data-block" title="Permalink to this headline">¶</a></h4>
<p>It specifies an external electric field.
For instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%block ExternalElectricField
0.000  0.000  0.0500  V/Ang
%endblock ExternalElectricField
</pre></div>
</div>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">No</span> <span class="pre">default</span> <span class="pre">values</span></code></p>
</div>
<div class="section" id="td-gaugefield-data-block">
<h4>TD.GaugeField ( <em>data block</em> )<a class="headerlink" href="#td-gaugefield-data-block" title="Permalink to this headline">¶</a></h4>
<p>It specifies an external vector gauge field.
For instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%block TD.GaugeField
0.000  0.000  0.0500  V/Ang
%endblock TD.GaugeField
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is highly experimental. Do not use it now.</p>
</div>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">No</span> <span class="pre">default</span> <span class="pre">values</span></code></p>
</div>
<div class="section" id="td-deltaelectricfield-logical">
<h4>TD.DeltaElectricField ( <em>Logical</em> )<a class="headerlink" href="#td-deltaelectricfield-logical" title="Permalink to this headline">¶</a></h4>
<p>Specify a delta electric field. Then gaussian electric field will be ignored.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">.False.</span></code></p>
</div>
<div class="section" id="td-lightfrequency-real-frequency">
<h4>TD.LightFrequency ( <em>Real Frequency</em> )<a class="headerlink" href="#td-lightfrequency-real-frequency" title="Permalink to this headline">¶</a></h4>
<p>The frequency <span class="math notranslate nohighlight">\(f\)</span> of the electric field.
<code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">0.5</span> <span class="pre">fs</span></code></p>
</div>
<div class="section" id="td-lightinitialtime-real-time">
<h4>TD.LightInitialTime ( <em>Real time</em> )<a class="headerlink" href="#td-lightinitialtime-real-time" title="Permalink to this headline">¶</a></h4>
<p>The initial time <span class="math notranslate nohighlight">\(t_0\)</span> to introduce the electric field.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">100.0</span> <span class="pre">fs</span></code></p>
</div>
<div class="section" id="td-lighttimescale-real-time">
<h4>TD.LightTimeScale ( <em>Real time</em> )<a class="headerlink" href="#td-lighttimescale-real-time" title="Permalink to this headline">¶</a></h4>
<p>The peak width <span class="math notranslate nohighlight">\(\sigma\)</span> of the wavepackage.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">25.0</span> <span class="pre">fs</span></code></p>
<div class="section" id="spatially-nonuniform-electric-field">
<h5>Spatially nonuniform electric field<a class="headerlink" href="#spatially-nonuniform-electric-field" title="Permalink to this headline">¶</a></h5>
<p>For spatially nonhomogeneous fields, only a function with nonzero values in the selected slab <span class="math notranslate nohighlight">\(z_{max}\)</span> to <span class="math notranslate nohighlight">\(z_{min}\)</span> is implemented.
Therefore,</p>
<p><span class="math notranslate nohighlight">\(E(t,z)=E(t) \theta(z-z_{min})(z_{max} -z)\)</span></p>
</div>
</div>
<div class="section" id="td-efzmin-real">
<h4>TD.EfZmin ( <em>Real</em> )<a class="headerlink" href="#td-efzmin-real" title="Permalink to this headline">¶</a></h4>
<p>The lower boundary of the electric field. Unit in the percentage of the cell vector.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">0.333</span></code></p>
</div>
<div class="section" id="td-efzmax-real">
<h4>TD.EfZmax ( <em>Real</em> )<a class="headerlink" href="#td-efzmax-real" title="Permalink to this headline">¶</a></h4>
<p>The upper boundary of the electric field. Unit in percentage of the cell vector.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">0.666</span></code></p>
</div>
</div>
</div>
<div class="section" id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="band-projection">
<h3>Band projection<a class="headerlink" href="#band-projection" title="Permalink to this headline">¶</a></h3>
<div class="section" id="td-writedmofselectiveorbitals-logical">
<h4>TD.WriteDMOfSelectiveOrbitals ( <em>Logical</em> )<a class="headerlink" href="#td-writedmofselectiveorbitals-logical" title="Permalink to this headline">¶</a></h4>
<p>Whether to output the partial DM of centain band and orbital projection.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">false</span></code></p>
</div>
<div class="section" id="td-partialdmband-data-block">
<h4>TD.PartialDMBand ( <em>data block</em> )<a class="headerlink" href="#td-partialdmband-data-block" title="Permalink to this headline">¶</a></h4>
<p>Specify the band to output and orbital projection. See also <strong>TD.PartialDMSumOrbitals</strong>.</p>
<p>Multiple lines with each of them include one band index. The corresponding charge density will be projected to the selected orbital blocks, and output to file: chg*Band Index*.txt</p>
<p>For instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%block TD.PartialDMBand
1
2
%endblock TD.PartialDMBand
</pre></div>
</div>
<p>will analysis the band 1-2 and projected them to the orbital blocks.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">No</span> <span class="pre">default</span> <span class="pre">values</span></code></p>
</div>
<div class="section" id="td-partialdmsumorbitals-data-block">
<h4>TD.PartialDMSumOrbitals ( <em>data block</em> )<a class="headerlink" href="#td-partialdmsumorbitals-data-block" title="Permalink to this headline">¶</a></h4>
<p>Specify orbital blocks for projection. See also <strong>TD.PartialDMBand</strong>.</p>
<p>Multiple lines with each of them include the start index and the end index of the orbital. The corresponding charge density will be projected to the selected orbital blocks, and output to file: chg*Band Index*.txt</p>
<p>For instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%block TD.PartialDMSumOrbitals
1 10
11 22
%endblock TD.PartialDMSumOrbitals
</pre></div>
</div>
<p>will analysis the selected band (using <strong>TD.PartialDMBand</strong> ) and projected them to the two orbital blocks: 1 to 10 and 11 to 22.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">No</span> <span class="pre">default</span> <span class="pre">values</span></code></p>
</div>
</div>
</div>
<div class="section" id="restart-a-tddft-md-calculation">
<h2>Restart a TDDFT-MD calculation<a class="headerlink" href="#restart-a-tddft-md-calculation" title="Permalink to this headline">¶</a></h2>
<p>To restart a calculation, the wavefunction and the atomic positions are needed. The atomic positions can be obtained in the file systemLabel.XV, and the wavefunction should be output using the following tag,</p>
<p>If TD.WriteWaveFunctionStep = x, it means to output the wavefunction every x step to the file <strong>systemLabel.step.TDWFSX</strong>. <strong>step</strong> is the certain step at which the wavefunction is output.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">1000</span></code></p>
<p>Whether to read wavefunction from the file <strong>systemLabel.TDWFSX</strong>.</p>
<p><code class="samp docutils literal notranslate"><span class="pre">Default</span> <span class="pre">value:</span> <span class="pre">false</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note: the systemLabel is not followed by <strong>step</strong>.</p>
</div>
<p>For instance:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir restartdir
cp H.psf  O.psf  siesta.EIG  siesta.PAR  input.fdf  structure.fdf  siesta.XV <span class="se">\</span>
siesta.VERLET_RESTART siesta.TDWFSX  restartdir
</pre></div>
</div>
<p>Add this in restartdir/input.fdf</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TD.ReadWaveFunction              T
MD.UsesaveXV T
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Contributors.html" class="btn btn-neutral float-right" title="Contributors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Compilation.html" class="btn btn-neutral float-left" title="Compilation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2008-2020, TDAP

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>